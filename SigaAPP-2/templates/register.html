{% extends "layout.html" %}

{% block title %}Registrar Solicitação{% endblock %}

{% block content %}
<h2>Registrar Solicitação</h2>
<form method="POST">
  <div class="form-group">
    <label for="parent_name">Nome do Responsável (Pai/Mãe):</label>
    <input type="text" class="form-control" id="parent_name" name="parent_name" required>
  </div>

  <div class="form-group">
    <label for="child_name">Aluno:</label>
    <input type="text" class="form-control" id="child_name" name="child_name" required>
  </div>

  <!-- Origem da Solicitação -->
  <div class="form-group">
    <label for="origem">Origem da Solicitação:</label>
    <select class="form-control" id="origem" name="origem" required>
      <option value="">Selecione...</option>
      <option value="Pessoalmente">Pessoalmente</option>
      <option value="Ligação">Ligação</option>
      <option value="WhatsAPP">WhatsAPP</option>
    </select>
  </div>

  <!-- Telefone de Contato (aparece se a origem for Ligação ou WhatsAPP) -->
  <div class="form-group" id="telefone-div" style="display: none;">
    <label for="telefone">Telefone de Contato:</label>
    <input type="text" class="form-control" id="telefone" name="telefone">
  </div>

  <!-- Campo de Descrição (exibido SOMENTE se NÃO for WhatsAPP) -->
  <div class="form-group" id="descricao-div" style="display: none;">
    <label for="description">Descrição:</label>
    <textarea class="form-control" id="description" name="description" rows="4"></textarea>
  </div>

  <!-- Mensagem Original do WhatsAPP (exibida SOMENTE se for WhatsAPP) -->
  <div class="form-group" id="whatsapp-div" style="display: none;">
    <label for="whatsapp_message">Mensagem Original do WhatsAPP:</label>
    <textarea class="form-control" id="whatsapp_message" name="whatsapp_message" rows="3"></textarea>
  </div>

  <!-- Seleção de Série -->
  <div class="form-group">
    <label for="series">Série:</label>
    <select class="form-control" id="series" name="series" required>
      <option value="">Selecione...</option>
      <option value="JUNIORS 1">JUNIORS 1</option>
      <option value="JUNIORS 2">JUNIORS 2</option>
      <option value="JUNIORS 3">JUNIORS 3</option>
      <option value="JUNIORS 4">JUNIORS 4</option>
      <option value="JUNIORS 5">JUNIORS 5</option>
    </select>
  </div>

  <!-- Seleção de Turma -->
  <div class="form-group">
    <label for="turma">Turma:</label>
    <select class="form-control" id="turma" name="turma" required>
      <option value="">Selecione a Turma</option>
    </select>
  </div>

  <!-- Categoria -->
  <div class="form-group">
    <label for="category">Categoria:</label>
    <select class="form-control" id="category" name="category" required>
      <option value="">Selecione...</option>
      <option value="RECLAMAÇÃO">RECLAMAÇÃO</option>
      <option value="SUGESTÃO">SUGESTÃO</option>
      <option value="DÚVIDAS">DÚVIDAS</option>
      <option value="PEDIDOS">PEDIDOS</option>
      <option value="DOENÇA">DOENÇA</option>
    </select>
  </div>

  <!-- Subcategoria: exibida somente se categoria for PEDIDOS -->
  <div class="form-group" id="subcat-div" style="display: none;">
    <label for="subcategory">Subcategoria (se for PEDIDOS):</label>
    <select class="form-control" id="subcategory" name="subcategory">
      <option value="">Nenhuma</option>
      <option value="SAÍDA ANTECIPADA">SAÍDA ANTECIPADA</option>
      <option value="AUTORIZACAO DE SAÍDA">AUTORIZACAO DE SAÍDA</option>
      <option value="PEDIDO PARA REUNIÃO">PEDIDO PARA REUNIÃO</option>
    </select>
  </div>

  <!-- Coordenadora Responsável -->
  <div class="form-group">
    <label for="coordinator">Coordenadora Responsável:</label>
    <select class="form-control" id="coordinator" name="coordinator" required>
      <option value="">Selecione...</option>
      <option value="Jéssica">Jéssica</option>
      <option value="Bruna">Bruna</option>
      <option value="Flávia">Flávia</option>
    </select>
  </div>

  <!-- Checkbox de áudio -->
  <div class="form-check">
    <input class="form-check-input" type="checkbox" id="possui_audio" name="possui_audio">
    <label class="form-check-label" for="possui_audio">Possui Áudio</label>
  </div>

  <br>
  <button type="submit" class="btn btn-primary">Registrar Solicitação</button>
</form>

<script>
  // Atualiza as opções de Turma com base na Série selecionada
  document.getElementById('series').addEventListener('change', function() {
    var series = this.value;
    var turmaSelect = document.getElementById('turma');
    var options = [];

    if (series === "JUNIORS 1" || series === "JUNIORS 2" || series === "JUNIORS 5") {
      options = ["A", "B", "C", "D"];
    } else if (series === "JUNIORS 3" || series === "JUNIORS 4") {
      options = ["A", "B", "C"];
    } else {
      options = [];
    }
    turmaSelect.innerHTML = '<option value="">Selecione a Turma</option>';
    options.forEach(function(turma) {
      var option = document.createElement('option');
      option.value = turma;
      option.text = turma;
      turmaSelect.appendChild(option);
    });
  });

  // Exibe ou esconde o campo de subcategoria com base na categoria selecionada
  document.getElementById('category').addEventListener('change', function() {
    var category = this.value;
    var subcatDiv = document.getElementById('subcat-div');
    if (category === "PEDIDOS") {
      subcatDiv.style.display = "block";
    } else {
      subcatDiv.style.display = "none";
      document.getElementById('subcategory').value = "";
    }
  });

  // Exibe ou esconde os campos com base na origem selecionada
  const origemSelect = document.getElementById('origem');
  const telefoneDiv = document.getElementById('telefone-div');
  const descricaoDiv = document.getElementById('descricao-div');
  const whatsappDiv = document.getElementById('whatsapp-div');
  const descriptionField = document.getElementById('description');
  const whatsappField = document.getElementById('whatsapp_message');

  origemSelect.addEventListener('change', function() {
    var origem = this.value;

    // Telefone é exibido se for Ligação ou WhatsAPP
    if (origem === "Ligação" || origem === "WhatsAPP") {
      telefoneDiv.style.display = "block";
    } else {
      telefoneDiv.style.display = "none";
      document.getElementById('telefone').value = "";
    }

    // Se origem for WhatsAPP, exibe "Mensagem Original" e esconde "Descrição"
    if (origem === "WhatsAPP") {
      whatsappDiv.style.display = "block";
      descricaoDiv.style.display = "none";
      descriptionField.value = "";
    }
    // Se for outra origem, exibe "Descrição" e esconde "Mensagem Original"
    else {
      whatsappDiv.style.display = "none";
      whatsappField.value = "";
      descricaoDiv.style.display = "block";
    }
  });
</script>
{% endblock %}
